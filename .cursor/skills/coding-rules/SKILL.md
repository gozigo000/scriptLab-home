---
name: coding-rules
description: scriptLab-home 프로젝트의 VBA 코딩 규칙. 모든 코드는 80자 라인 제한을 준수하고, _utils 모듈의 기존 코드를 우선적으로 재사용해야 함.
---

# 코딩 규칙

이 스킬은 `scriptLab-home` 프로젝트의 VBA 코드 작성 시
반드시 준수해야 하는 규칙을 정의합니다.

## 핵심 규칙

### 1. 라인 길이 제한 (필수)
- 모든 코드, 주석, 문자열은 **한 줄에 최대 80자**를
  넘기지 않는다.
- 80자를 넘을 경우 적절한 위치에서 줄바꿈한다.
  - 공백 뒤, 연산자 뒤에서 줄바꿈
  - 문자열 연결 시 `& _` 패턴 사용

### 2. _utils 코드 재사용 (필수)
- **새 기능 구현 전 반드시 확인**: `myVba\_utils` 디렉터리의
  모듈, 함수, 클래스를 먼저 확인한다.
- **중복 방지**: `_utils`에 유사 기능이 이미 존재하면
  반드시 재사용하고, 같은 역할의 코드를 새로 만들지 않는다.
- **공통 기능 분리**: 여러 곳에서 재사용될 가능성이 있는
  기능은 `myVba\_utils` 아래 적절한 모듈로 분리한다.
- **문서화**: 새로 추가한 공통 함수에는 사용 예와
  동작 설명을 주석으로 남긴다.

### 3. 모듈·함수 작성
- **단일 책임**: 하나의 함수/서브는 하나의 명확한 책임만
  갖도록 작성한다.
- **헬퍼 분리**: 복잡한 로직은 의미 있는 이름의 헬퍼 함수로
  분리하고, 공통으로 쓰일 수 있으면 `_utils`로 이동을
  우선 고려한다.
- **Public 문서화**: Public 함수·서브에는 역할 요약,
  인자 의미, 반환값을 주석으로 남긴다.

### 4. 이름 짓기
- **가독성 우선**: 변수, 함수, 모듈 이름은 역할이 바로
  이해되도록 명확하게 짓는다.
- **약어 제한**: 프로젝트 전체에서 의미가 충분히 공유된
  경우에만 약어를 사용한다.
- **Boolean 접두어**: `is`, `has`, `can`, `should`
  등으로 시작하여 참/거짓 의미를 드러낸다.

### 5. 에러 처리
- **에러 가능 지점**: 파일/디스크 접근, 외부 입력 처리,
  Selection/Range 조작, 타입 변환 등에는 에러 처리를
  반드시 고려한다.
- **공통 처리 활용**: `_utils`에 에러 로깅, 메시지 출력 등
  공통 함수가 있으면 우선적으로 사용한다.

### 6. 주석 및 문서화
- **"왜"에 집중**: 주석은 "무엇을 했는가"보다
  "왜 이렇게 했는가"를 설명한다.
- **필요한 곳에만**: 코드만 보아도 자명한 내용은 주석으로
  반복하지 않는다. 알고리즘, 전제 조건, 제약 사항,
  성능 이슈 등은 주석으로 남긴다.
- **모듈 헤더**: 중요 모듈 상단에는 다음 내용을 간단히 적는다.  
  - 모듈 역할  
  - 주요 공개 함수 목록  
  - 관련된 `_utils` 모듈이 있는 경우 그 위치

### 7. 스타일 및 정렬
- **들여쓰기**: Space 4개를 일관되게 사용한다.
- **블록 정렬**: `If`, `For`, `Do`, `With` 등 블록 구조는
  들여쓰기를 맞추고, `End If`, `Next`, `Loop`, `End With`를
  같은 깊이에 맞춰 정렬한다.
- **공백 사용**: 연산자 앞뒤, 콤마 뒤에는 적절히 공백을
  넣어 가독성을 높인다.

## 적용 범위
- `myVba` 디렉터리 이하의 모든 VBA 코드에 적용한다.

## 참고 문서

- 자세한 내용은 프로젝트 루트의 `CODING_RULES.md` 파일을
  참고한다.
